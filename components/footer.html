<footer class="wrapper-fw bg-h1" id="contact">
  <div class="container grid-split-rows pp">
    <h2>Contact us</h2>
    <div class="max-width-m border-b" id="hubspot-form-container">
      <script>
        // Cargar HubSpot de forma diferida para mejorar FCP y LCP
        (function () {
          // Solo cargar cuando el usuario está cerca del formulario o después de un delay
          let hubspotLoaded = false;

          function loadHubSpotForm() {
            if (hubspotLoaded) return;
            hubspotLoaded = true;

            const script = document.createElement("script");
            script.charset = "utf-8";
            script.type = "text/javascript";
            script.src = "https://js.hsforms.net/forms/embed/v2.js";
            script.async = true;
            script.onload = function () {
              if (window.hbspt && window.hbspt.forms) {
                hbspt.forms.create({
                  region: "na1",
                  portalId: "39812753",
                  formId: "5cf03715-f363-45c5-925f-ed8e2d337450",
                  target: "#hubspot-form-container",
                });
              }
            };
            document.head.appendChild(script);
          }

          // Cargar cuando el usuario hace scroll cerca del formulario
          const formContainer = document.getElementById(
            "hubspot-form-container"
          );
          if (formContainer) {
            const observer = new IntersectionObserver(
              (entries) => {
                entries.forEach((entry) => {
                  if (entry.isIntersecting) {
                    loadHubSpotForm();
                    observer.disconnect();
                  }
                });
              },
              {
                rootMargin: "200px", // Cargar cuando está a 200px de distancia
              }
            );

            observer.observe(formContainer);

            // Fallback: cargar después de 3 segundos si no se ha hecho scroll
            setTimeout(() => {
              if (!hubspotLoaded) {
                loadHubSpotForm();
              }
            }, 3000);
          }
        })();
      </script>
    </div>
    <div class="footer-links">
      <p>
        Copyright ROOTS <span id="current-year">2023</span>. All rights
        reserved.
      </p>
      <div class="social">
        <a href="/terms-and-conditions">Terms and conditions</a>
        <a href="/privacy-policy">Privacy Policy</a>
        <div class="social">
          <a
            target="_blank"
            class="icon tw"
            href="https://twitter.com/rootstradenolog"
            aria-label="Follow ROOTS on Twitter"
          >
            <span class="sr-only">Follow ROOTS on Twitter</span>
          </a>
        </div>
      </div>
    </div>
  </div>
</footer>
